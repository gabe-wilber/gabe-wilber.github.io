{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import{Audio}from'expo-av';import AssetUtils from'expo-asset-utils';import AudioFiles from\"./Audio\";import Platform from\"react-native-web/dist/exports/Platform\";var MUTED=Platform.OS==='web';var AudioManager=function(){function AudioManager(){var _this=this;_classCallCheck(this,AudioManager);this.sounds={};this.audioFileMoveIndex=0;this.playMoveSound=function _callee(){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(_this.playAsync(_this.sounds.chicken.move[\"\"+_this.audioFileMoveIndex]));case 2:_this.audioFileMoveIndex=(_this.audioFileMoveIndex+1)%Object.keys(_this.sounds.chicken.move).length;case 3:case\"end\":return _context.stop();}}});};this.playPassiveCarSound=function _callee2(){return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(Math.floor(Math.random()*2)===0)){_context2.next=3;break;}_context2.next=3;return _regeneratorRuntime.awrap(_this.playAsync(_this.sounds.car.passive[\"1\"]));case 3:case\"end\":return _context2.stop();}}});};this.playDeathSound=function _callee3(){return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(_this.playAsync(_this.sounds.chicken.die[\"\"+Math.floor(Math.random()*2)]));case 2:case\"end\":return _context3.stop();}}});};this.playCarHitSound=function _callee4(){return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(_this.playAsync(_this.sounds.car.die[\"\"+Math.floor(Math.random()*2)]));case 2:case\"end\":return _context4.stop();}}});};this.playAsync=function _callee5(soundObject,isLooping){var startOver,_args5=arguments;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:startOver=_args5.length>2&&_args5[2]!==undefined?_args5[2]:true;if(!MUTED){_context5.next=3;break;}return _context5.abrupt(\"return\");case 3:_context5.prev=3;if(!startOver){_context5.next=7;break;}_context5.next=7;return _regeneratorRuntime.awrap(soundObject.setPositionAsync(0));case 7:_context5.next=9;return _regeneratorRuntime.awrap(soundObject.setIsLoopingAsync(isLooping));case 9:_context5.next=11;return _regeneratorRuntime.awrap(soundObject.playAsync());case 11:_context5.next=16;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](3);console.warn('Error playing audio',{error:_context5.t0});case 16:case\"end\":return _context5.stop();}}},null,null,[[3,13]]);};this.stopAsync=function _callee6(name){var soundObject;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!_this.sounds.hasOwnProperty(name)){_context6.next=12;break;}soundObject=_this.sounds[name];_context6.prev=2;_context6.next=5;return _regeneratorRuntime.awrap(soundObject.stopAsync());case 5:_context6.next=10;break;case 7:_context6.prev=7;_context6.t0=_context6[\"catch\"](2);console.warn('Error stopping audio',{error:_context6.t0});case 10:_context6.next=13;break;case 12:console.warn(\"Audio doesn't exist\",name);case 13:case\"end\":return _context6.stop();}}},null,null,[[2,7]]);};this.volumeAsync=function _callee7(name,volume){var soundObject;return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!_this.sounds.hasOwnProperty(name)){_context7.next=12;break;}soundObject=_this.sounds[name];_context7.prev=2;_context7.next=5;return _regeneratorRuntime.awrap(soundObject.setVolumeAsync(volume));case 5:_context7.next=10;break;case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](2);console.warn('Error setting volume of audio',{error:_context7.t0});case 10:_context7.next=13;break;case 12:console.warn(\"Audio doesn't exist\",name);case 13:case\"end\":return _context7.stop();}}},null,null,[[2,7]]);};this.pauseAsync=function _callee8(name){var soundObject;return _regeneratorRuntime.async(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!_this.sounds.hasOwnProperty(name)){_context8.next=12;break;}soundObject=_this.sounds[name];_context8.prev=2;_context8.next=5;return _regeneratorRuntime.awrap(soundObject.pauseAsync());case 5:_context8.next=10;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](2);console.warn('Error pausing audio',{error:_context8.t0});case 10:_context8.next=13;break;case 12:console.warn(\"Audio doesn't exist\",name);case 13:case\"end\":return _context8.stop();}}},null,null,[[2,7]]);};this.configureExperienceAudioAsync=function _callee9(){return _regeneratorRuntime.async(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return _regeneratorRuntime.awrap(Audio.setIsEnabledAsync(true));case 2:case\"end\":return _context9.stop();}}});};this.setupAudioAsync=function _callee10(){return _regeneratorRuntime.async(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return _regeneratorRuntime.awrap(clone(_this.assets));case 2:_this.sounds=_context10.sent;case 3:case\"end\":return _context10.stop();}}});};this.downloadAsync=function _callee11(){return _regeneratorRuntime.async(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:return _context11.abrupt(\"return\",AssetUtils.cacheAssetsAsync({files:_toConsumableArray(AssetUtils.arrayFromObject(_this.assets))}));case 1:case\"end\":return _context11.stop();}}});};this.setupAsync=function _callee12(){return _regeneratorRuntime.async(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(!MUTED){_context12.next=2;break;}return _context12.abrupt(\"return\",_this.setupAudioAsync());case 2:return _context12.abrupt(\"return\",Promise.all([_this.configureExperienceAudioAsync(),_this.downloadAsync(),_this.setupAudioAsync()]));case 3:case\"end\":return _context12.stop();}}});};}_createClass(AudioManager,[{key:\"assets\",get:function get(){return AudioFiles;}}]);return AudioManager;}();function clone(obj){var _ref,sound,temp,key;return _regeneratorRuntime.async(function clone$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(!(obj===null||typeof obj!=='object'||'isActiveClone'in obj)){_context13.next=10;break;}if(!(typeof obj==='string'||typeof obj==='number')){_context13.next=9;break;}if(!MUTED){_context13.next=4;break;}return _context13.abrupt(\"return\",null);case 4:_context13.next=6;return _regeneratorRuntime.awrap(Audio.Sound.create(obj));case 6:_ref=_context13.sent;sound=_ref.sound;return _context13.abrupt(\"return\",sound);case 9:return _context13.abrupt(\"return\",obj);case 10:if(obj instanceof Date){temp=new obj.constructor();}else{temp=obj.constructor();}_context13.t0=_regeneratorRuntime.keys(obj);case 12:if((_context13.t1=_context13.t0()).done){_context13.next=22;break;}key=_context13.t1.value;if(!Object.prototype.hasOwnProperty.call(obj,key)){_context13.next=20;break;}obj['isActiveClone']=null;_context13.next=18;return _regeneratorRuntime.awrap(clone(obj[key]));case 18:temp[key]=_context13.sent;delete obj['isActiveClone'];case 20:_context13.next=12;break;case 22:return _context13.abrupt(\"return\",temp);case 23:case\"end\":return _context13.stop();}}});}export default new AudioManager();","map":{"version":3,"sources":["/Users/gabew/Codelation-Projects/gabe-wilber.github.io/src/AudioManager.js"],"names":["Audio","AssetUtils","AudioFiles","MUTED","Platform","OS","AudioManager","sounds","audioFileMoveIndex","playMoveSound","playAsync","chicken","move","Object","keys","length","playPassiveCarSound","Math","floor","random","car","passive","playDeathSound","die","playCarHitSound","soundObject","isLooping","startOver","setPositionAsync","setIsLoopingAsync","console","warn","error","stopAsync","name","hasOwnProperty","volumeAsync","volume","setVolumeAsync","pauseAsync","configureExperienceAudioAsync","setIsEnabledAsync","setupAudioAsync","clone","assets","downloadAsync","cacheAssetsAsync","files","arrayFromObject","setupAsync","Promise","all","obj","Sound","create","sound","Date","temp","constructor","key","prototype","call"],"mappings":"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","sourcesContent":["import { Audio } from 'expo-av';\n// import Assets from './Assets';\nimport AssetUtils from 'expo-asset-utils';\nimport AudioFiles from './Audio';\nimport { Platform } from 'react-native';\n\n// Web just can't seem to handle audio\nconst MUTED = Platform.OS === 'web';\n\nclass AudioManager {\n  sounds = {};\n\n  audioFileMoveIndex = 0;\n\n  playMoveSound = async () => {\n    await this.playAsync(\n      this.sounds.chicken.move[`${this.audioFileMoveIndex}`],\n    );\n    this.audioFileMoveIndex =\n      (this.audioFileMoveIndex + 1) %\n      Object.keys(this.sounds.chicken.move).length;\n  };\n\n  playPassiveCarSound = async () => {\n    if (Math.floor(Math.random() * 2) === 0) {\n      await this.playAsync(this.sounds.car.passive[`1`]);\n    }\n  };\n\n  playDeathSound = async () => {\n    await this.playAsync(\n      this.sounds.chicken.die[`${Math.floor(Math.random() * 2)}`],\n    );\n  };\n\n  playCarHitSound = async () => {\n    await this.playAsync(\n      this.sounds.car.die[`${Math.floor(Math.random() * 2)}`],\n    );\n  };\n\n  playAsync = async (soundObject, isLooping, startOver = true) => {\n    if (MUTED) return;\n    // if (store.getState().muted) {\n    //   return;\n    // }\n\n    // if (this.sounds.hasOwnProperty(name)) {\n    //   const soundObject = this.sounds[name];\n    try {\n      if (startOver) {\n        await soundObject.setPositionAsync(0);\n      }\n\n      await soundObject.setIsLoopingAsync(isLooping);\n      await soundObject.playAsync();\n    } catch (error) {\n      console.warn('Error playing audio', { error });\n    }\n    // } else {\n    //   console.warn(\"Audio doesn't exist\", name);\n    //   console.log('Audio: Expected one of: ', this.sounds);\n    // }\n  };\n  stopAsync = async name => {\n    if (this.sounds.hasOwnProperty(name)) {\n      const soundObject = this.sounds[name];\n      try {\n        await soundObject.stopAsync();\n      } catch (error) {\n        console.warn('Error stopping audio', { error });\n      }\n    } else {\n      console.warn(\"Audio doesn't exist\", name);\n    }\n  };\n  volumeAsync = async (name, volume) => {\n    if (this.sounds.hasOwnProperty(name)) {\n      const soundObject = this.sounds[name];\n      try {\n        await soundObject.setVolumeAsync(volume);\n      } catch (error) {\n        console.warn('Error setting volume of audio', { error });\n      }\n    } else {\n      console.warn(\"Audio doesn't exist\", name);\n    }\n  };\n\n  pauseAsync = async name => {\n    if (this.sounds.hasOwnProperty(name)) {\n      const soundObject = this.sounds[name];\n      try {\n        await soundObject.pauseAsync();\n      } catch (error) {\n        console.warn('Error pausing audio', { error });\n      }\n    } else {\n      console.warn(\"Audio doesn't exist\", name);\n    }\n  };\n\n  configureExperienceAudioAsync = async () => {\n    await Audio.setIsEnabledAsync(true);\n    // await Audio.setAudioModeAsync({\n    //   allowsRecordingIOS: false,\n    //   interruptionModeIOS: Audio.INTERRUPTION_MODE_IOS_DO_NOT_MIX,\n    //   playsInSilentModeIOS: false,\n    //   shouldDuckAndroid: true,\n    //   interruptionModeAndroid: Audio.INTERRUPTION_MODE_ANDROID_DO_NOT_MIX,\n    // });\n  };\n\n  get assets() {\n    return AudioFiles;\n  }\n\n  setupAudioAsync = async () => {\n    this.sounds = await clone(this.assets);\n    // console.log('sounds', this.sounds);\n  };\n\n  downloadAsync = async () =>\n    AssetUtils.cacheAssetsAsync({\n      files: [...AssetUtils.arrayFromObject(this.assets)],\n    });\n\n  setupAsync = async () => {\n    if (MUTED) {\n      return this.setupAudioAsync();\n    }\n\n    return Promise.all([\n      this.configureExperienceAudioAsync(),\n      this.downloadAsync(),\n      this.setupAudioAsync(),\n    ]);\n  };\n}\n\nasync function clone(obj) {\n  if (obj === null || typeof obj !== 'object' || 'isActiveClone' in obj) {\n    if (typeof obj === 'string' || typeof obj === 'number') {\n      if (MUTED) return null;\n      const { sound } = await Audio.Sound.create(obj);\n      return sound;\n    }\n    return obj;\n  }\n\n  if (obj instanceof Date) {\n    var temp = new obj.constructor(); //or new Date(obj);\n  } else {\n    var temp = obj.constructor();\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      obj['isActiveClone'] = null;\n      temp[key] = await clone(obj[key]);\n      delete obj['isActiveClone'];\n    }\n  }\n  return temp;\n}\n\nexport default new AudioManager();\n"]},"metadata":{},"sourceType":"module"}