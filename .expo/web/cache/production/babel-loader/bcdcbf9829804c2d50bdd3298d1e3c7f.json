{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{Asset}from'expo-asset';import{Platform}from'@unimodules/core';import ExponentAV from\"./ExponentAV\";export var PitchCorrectionQuality;(function(PitchCorrectionQuality){PitchCorrectionQuality[PitchCorrectionQuality[\"Low\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.Low]=\"Low\";PitchCorrectionQuality[PitchCorrectionQuality[\"Medium\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.Medium]=\"Medium\";PitchCorrectionQuality[PitchCorrectionQuality[\"High\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.High]=\"High\";})(PitchCorrectionQuality||(PitchCorrectionQuality={}));export var _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS=500;export var _DEFAULT_INITIAL_PLAYBACK_STATUS={positionMillis:0,progressUpdateIntervalMillis:_DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS,shouldPlay:false,rate:1.0,shouldCorrectPitch:false,volume:1.0,isMuted:false,isLooping:false};export function getNativeSourceFromSource(source){var uri=null;var overridingExtension=null;var headers;if(typeof source==='string'&&Platform.OS==='web'){return{uri:source,overridingExtension:overridingExtension,headers:headers};}var asset=_getAssetFromPlaybackSource(source);if(asset!=null){uri=asset.localUri||asset.uri;}else if(source!=null&&typeof source!=='number'&&'uri'in source&&typeof source.uri==='string'){uri=source.uri;}if(uri==null){return null;}if(source!=null&&typeof source!=='number'&&'overrideFileExtensionAndroid'in source&&typeof source.overrideFileExtensionAndroid==='string'){overridingExtension=source.overrideFileExtensionAndroid;}if(source!=null&&typeof source!=='number'&&'headers'in source&&typeof source.headers==='object'){headers=source.headers;}return{uri:uri,overridingExtension:overridingExtension,headers:headers};}function _getAssetFromPlaybackSource(source){if(source==null){return null;}var asset=null;if(typeof source==='number'){asset=Asset.fromModule(source);}else if(source instanceof Asset){asset=source;}return asset;}export function assertStatusValuesInBounds(status){if(typeof status.rate==='number'&&(status.rate<0||status.rate>32)){throw new RangeError('Rate value must be between 0.0 and 32.0');}if(typeof status.volume==='number'&&(status.volume<0||status.volume>1)){throw new RangeError('Volume value must be between 0.0 and 1.0');}}export function getNativeSourceAndFullInitialStatusForLoadAsync(source,initialStatus,downloadFirst){var fullInitialStatus,asset,nativeSource;return _regeneratorRuntime.async(function getNativeSourceAndFullInitialStatusForLoadAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:fullInitialStatus=initialStatus==null?_DEFAULT_INITIAL_PLAYBACK_STATUS:_objectSpread({},_DEFAULT_INITIAL_PLAYBACK_STATUS,{},initialStatus);assertStatusValuesInBounds(fullInitialStatus);if(!(typeof source==='string'&&Platform.OS==='web')){_context.next=4;break;}return _context.abrupt(\"return\",{nativeSource:{uri:source,overridingExtension:null},fullInitialStatus:fullInitialStatus});case 4:asset=_getAssetFromPlaybackSource(source);if(!(downloadFirst&&asset)){_context.next=8;break;}_context.next=8;return _regeneratorRuntime.awrap(asset.downloadAsync());case 8:nativeSource=getNativeSourceFromSource(source);if(!(nativeSource===null)){_context.next=11;break;}throw new Error(\"Cannot load an AV asset from a null playback source\");case 11:return _context.abrupt(\"return\",{nativeSource:nativeSource,fullInitialStatus:fullInitialStatus});case 12:case\"end\":return _context.stop();}}});}export function getUnloadedStatus(){var error=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return _objectSpread({isLoaded:false},error?{error:error}:null);}export var PlaybackMixin={playAsync:function playAsync(){return _regeneratorRuntime.async(function playAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",this.setStatusAsync({shouldPlay:true}));case 1:case\"end\":return _context2.stop();}}},null,this);},playFromPositionAsync:function playFromPositionAsync(positionMillis){var tolerances,_args3=arguments;return _regeneratorRuntime.async(function playFromPositionAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:tolerances=_args3.length>1&&_args3[1]!==undefined?_args3[1]:{};return _context3.abrupt(\"return\",this.setStatusAsync({positionMillis:positionMillis,shouldPlay:true,seekMillisToleranceAfter:tolerances.toleranceMillisAfter,seekMillisToleranceBefore:tolerances.toleranceMillisBefore}));case 2:case\"end\":return _context3.stop();}}},null,this);},pauseAsync:function pauseAsync(){return _regeneratorRuntime.async(function pauseAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",this.setStatusAsync({shouldPlay:false}));case 1:case\"end\":return _context4.stop();}}},null,this);},stopAsync:function stopAsync(){return _regeneratorRuntime.async(function stopAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",this.setStatusAsync({positionMillis:0,shouldPlay:false}));case 1:case\"end\":return _context5.stop();}}},null,this);},setPositionAsync:function setPositionAsync(positionMillis){var tolerances,_args6=arguments;return _regeneratorRuntime.async(function setPositionAsync$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:tolerances=_args6.length>1&&_args6[1]!==undefined?_args6[1]:{};return _context6.abrupt(\"return\",this.setStatusAsync({positionMillis:positionMillis,seekMillisToleranceAfter:tolerances.toleranceMillisAfter,seekMillisToleranceBefore:tolerances.toleranceMillisBefore}));case 2:case\"end\":return _context6.stop();}}},null,this);},setRateAsync:function setRateAsync(rate){var shouldCorrectPitch,pitchCorrectionQuality,_args7=arguments;return _regeneratorRuntime.async(function setRateAsync$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:shouldCorrectPitch=_args7.length>1&&_args7[1]!==undefined?_args7[1]:false;pitchCorrectionQuality=_args7.length>2&&_args7[2]!==undefined?_args7[2]:PitchCorrectionQuality.Low;return _context7.abrupt(\"return\",this.setStatusAsync({rate:rate,shouldCorrectPitch:shouldCorrectPitch,pitchCorrectionQuality:pitchCorrectionQuality}));case 3:case\"end\":return _context7.stop();}}},null,this);},setVolumeAsync:function setVolumeAsync(volume){return _regeneratorRuntime.async(function setVolumeAsync$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",this.setStatusAsync({volume:volume}));case 1:case\"end\":return _context8.stop();}}},null,this);},setIsMutedAsync:function setIsMutedAsync(isMuted){return _regeneratorRuntime.async(function setIsMutedAsync$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:return _context9.abrupt(\"return\",this.setStatusAsync({isMuted:isMuted}));case 1:case\"end\":return _context9.stop();}}},null,this);},setIsLoopingAsync:function setIsLoopingAsync(isLooping){return _regeneratorRuntime.async(function setIsLoopingAsync$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:return _context10.abrupt(\"return\",this.setStatusAsync({isLooping:isLooping}));case 1:case\"end\":return _context10.stop();}}},null,this);},setProgressUpdateIntervalAsync:function setProgressUpdateIntervalAsync(progressUpdateIntervalMillis){return _regeneratorRuntime.async(function setProgressUpdateIntervalAsync$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:return _context11.abrupt(\"return\",this.setStatusAsync({progressUpdateIntervalMillis:progressUpdateIntervalMillis}));case 1:case\"end\":return _context11.stop();}}},null,this);}};","map":{"version":3,"sources":["../src/AV.ts"],"names":[],"mappings":"25BAAA,OAAS,KAAT,KAAsB,YAAtB,CACA,OAAS,QAAT,KAAyB,kBAAzB,CAEA,MAAO,CAAA,UAAP,oBAUA,MAAA,IAAY,CAAA,sBAAZ,CAAA,CAAA,SAAY,sBAAZ,CAAkC,CAChC,sBAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,CAAM,UAAU,EAAI,UAAU,CAAC,SAAzB,EAAsC,UAAU,CAAC,SAAX,CAAqB,GAAjE,CAAA,CAAoE,KAApE,CACA,sBAAA,CAAA,sBAAA,CAAA,QAAA,CAAA,CAAS,UAAU,EAAI,UAAU,CAAC,SAAzB,EAAsC,UAAU,CAAC,SAAX,CAAqB,MAApE,CAAA,CAA0E,QAA1E,CACA,sBAAA,CAAA,sBAAA,CAAA,MAAA,CAAA,CAAO,UAAU,EAAI,UAAU,CAAC,SAAzB,EAAsC,UAAU,CAAC,SAAX,CAAqB,IAAlE,CAAA,CAAsE,MAAtE,CACD,CAJD,EAAY,sBAAsB,GAAtB,sBAAsB,CAAA,EAAA,CAAlC,EAoEA,MAAO,IAAM,CAAA,wCAAwC,CAAW,GAAzD,CACP,MAAO,IAAM,CAAA,gCAAgC,CAAwB,CACnE,cAAc,CAAE,CADmD,CAEnE,4BAA4B,CAAE,wCAFqC,CAGnE,UAAU,CAAE,KAHuD,CAInE,IAAI,CAAE,GAJ6D,CAKnE,kBAAkB,CAAE,KAL+C,CAMnE,MAAM,CAAE,GAN2D,CAOnE,OAAO,CAAE,KAP0D,CAQnE,SAAS,CAAE,KARwD,CAA9D,CAWP,MAAM,SAAU,CAAA,yBAAV,CACJ,MADI,CAC0B,CAE9B,GAAI,CAAA,GAAG,CAAkB,IAAzB,CACA,GAAI,CAAA,mBAAmB,CAAkB,IAAzC,CACA,GAAI,CAAA,OAAJ,CAEA,GAAI,MAAO,CAAA,MAAP,GAAkB,QAAlB,EAA8B,QAAQ,CAAC,EAAT,GAAgB,KAAlD,CAAyD,CACvD,MAAO,CACL,GAAG,CAAE,MADA,CAEL,mBAAmB,CAAnB,mBAFK,CAGL,OAAO,CAAP,OAHK,CAAP,CAKD,CAED,GAAI,CAAA,KAAK,CAAiB,2BAA2B,CAAC,MAAD,CAArD,CACA,GAAI,KAAK,EAAI,IAAb,CAAmB,CACjB,GAAG,CAAG,KAAK,CAAC,QAAN,EAAkB,KAAK,CAAC,GAA9B,CACD,CAFD,IAEO,IACL,MAAM,EAAI,IAAV,EACA,MAAO,CAAA,MAAP,GAAkB,QADlB,EAEA,OAAS,CAAA,MAFT,EAGA,MAAO,CAAA,MAAM,CAAC,GAAd,GAAsB,QAJjB,CAKL,CACA,GAAG,CAAG,MAAM,CAAC,GAAb,CACD,CAED,GAAI,GAAG,EAAI,IAAX,CAAiB,CACf,MAAO,KAAP,CACD,CAED,GACE,MAAM,EAAI,IAAV,EACA,MAAO,CAAA,MAAP,GAAkB,QADlB,EAEA,gCAAkC,CAAA,MAFlC,EAGA,MAAO,CAAA,MAAM,CAAC,4BAAd,GAA+C,QAJjD,CAKE,CACA,mBAAmB,CAAG,MAAM,CAAC,4BAA7B,CACD,CAED,GACE,MAAM,EAAI,IAAV,EACA,MAAO,CAAA,MAAP,GAAkB,QADlB,EAEA,WAAa,CAAA,MAFb,EAGA,MAAO,CAAA,MAAM,CAAC,OAAd,GAA0B,QAJ5B,CAKE,CACA,OAAO,CAAG,MAAM,CAAC,OAAjB,CACD,CACD,MAAO,CAAE,GAAG,CAAH,GAAF,CAAO,mBAAmB,CAAnB,mBAAP,CAA4B,OAAO,CAAP,OAA5B,CAAP,CACD,CAED,QAAS,CAAA,2BAAT,CAAqC,MAArC,CAAmE,CACjE,GAAI,MAAM,EAAI,IAAd,CAAoB,CAClB,MAAO,KAAP,CACD,CAED,GAAI,CAAA,KAAK,CAAiB,IAA1B,CACA,GAAI,MAAO,CAAA,MAAP,GAAkB,QAAtB,CAAgC,CAC9B,KAAK,CAAG,KAAK,CAAC,UAAN,CAAiB,MAAjB,CAAR,CACD,CAFD,IAEO,IAAI,MAAM,WAAY,CAAA,KAAtB,CAA6B,CAClC,KAAK,CAAG,MAAR,CACD,CACD,MAAO,CAAA,KAAP,CACD,CAED,MAAM,SAAU,CAAA,0BAAV,CAAqC,MAArC,CAAgE,CACpE,GAAI,MAAO,CAAA,MAAM,CAAC,IAAd,GAAuB,QAAvB,GAAoC,MAAM,CAAC,IAAP,CAAc,CAAd,EAAmB,MAAM,CAAC,IAAP,CAAc,EAArE,CAAJ,CAA8E,CAC5E,KAAM,IAAI,CAAA,UAAJ,CAAe,yCAAf,CAAN,CACD,CACD,GAAI,MAAO,CAAA,MAAM,CAAC,MAAd,GAAyB,QAAzB,GAAsC,MAAM,CAAC,MAAP,CAAgB,CAAhB,EAAqB,MAAM,CAAC,MAAP,CAAgB,CAA3E,CAAJ,CAAmF,CACjF,KAAM,IAAI,CAAA,UAAJ,CAAe,0CAAf,CAAN,CACD,CACF,CAED,MAAO,SAAe,CAAA,+CAAf,CACL,MADK,CAEL,aAFK,CAGL,aAHK,oMASC,iBATD,CAUH,aAAa,EAAI,IAAjB,CACI,gCADJ,kBAGS,gCAHT,IAIS,aAJT,CAVG,CAgBL,0BAA0B,CAAC,iBAAD,CAA1B,CAhBK,KAkBD,MAAO,CAAA,MAAP,GAAkB,QAAlB,EAA8B,QAAQ,CAAC,EAAT,GAAgB,KAlB7C,0DAmBI,CACL,YAAY,CAAE,CACZ,GAAG,CAAE,MADO,CAEZ,mBAAmB,CAAE,IAFT,CADT,CAKL,iBAAiB,CAAjB,iBALK,CAnBJ,SA6BD,KA7BC,CA6BO,2BAA2B,CAAC,MAAD,CA7BlC,MA8BD,aAAa,EAAI,KA9BhB,2EAgCG,KAAK,CAAC,aAAN,EAhCH,SAoCC,YApCD,CAoC6C,yBAAyB,CAAC,MAAD,CApCtE,MAsCD,YAAY,GAAK,IAtChB,gCAuCG,IAAI,CAAA,KAAJ,uDAvCH,yCA0CE,CAAE,YAAY,CAAZ,YAAF,CAAgB,iBAAiB,CAAjB,iBAAhB,CA1CF,iDA6CP,MAAM,SAAU,CAAA,iBAAV,EAAuD,IAA3B,CAAA,KAA2B,2DAAJ,IAAI,CAC3D,sBACE,QAAQ,CAAE,KADZ,EAEM,KAAK,CAAG,CAAE,KAAK,CAAL,KAAF,CAAH,CAAe,IAF1B,EAID,CAiCD,MAAO,IAAM,CAAA,aAAa,CAAG,CACrB,SADqB,6KAEhB,KAAoB,cAApB,CAAmC,CAAE,UAAU,CAAE,IAAd,CAAnC,CAFgB,4DAKrB,qBALqB,gCAMzB,cANyB,oKAOzB,UAPyB,kDAOuD,EAPvD,kCAShB,KAAoB,cAApB,CAAmC,CAC1C,cAAc,CAAd,cAD0C,CAE1C,UAAU,CAAE,IAF8B,CAG1C,wBAAwB,CAAE,UAAU,CAAC,oBAHK,CAI1C,yBAAyB,CAAE,UAAU,CAAC,qBAJI,CAAnC,CATgB,4DAiBrB,UAjBqB,+KAkBhB,KAAoB,cAApB,CAAmC,CAAE,UAAU,CAAE,KAAd,CAAnC,CAlBgB,4DAqBrB,SArBqB,6KAsBhB,KAAoB,cAApB,CAAmC,CAAE,cAAc,CAAE,CAAlB,CAAqB,UAAU,CAAE,KAAjC,CAAnC,CAtBgB,4DAyBrB,gBAzBqB,2BA0BzB,cA1ByB,+JA2BzB,UA3ByB,kDA2BuD,EA3BvD,kCA6BhB,KAAoB,cAApB,CAAmC,CAC1C,cAAc,CAAd,cAD0C,CAE1C,wBAAwB,CAAE,UAAU,CAAC,oBAFK,CAG1C,yBAAyB,CAAE,UAAU,CAAC,qBAHI,CAAnC,CA7BgB,4DAoCrB,YApCqB,uBAqCzB,IArCyB,0LAsCzB,kBAtCyB,kDAsCK,KAtCL,CAuCzB,sBAvCyB,kDAuCwB,sBAAsB,CAAC,GAvC/C,kCAyChB,KAAoB,cAApB,CAAmC,CAC1C,IAAI,CAAJ,IAD0C,CAE1C,kBAAkB,CAAlB,kBAF0C,CAG1C,sBAAsB,CAAtB,sBAH0C,CAAnC,CAzCgB,4DAgDrB,cAhDqB,yBAgDN,MAhDM,8JAiDhB,KAAoB,cAApB,CAAmC,CAAE,MAAM,CAAN,MAAF,CAAnC,CAjDgB,4DAoDrB,eApDqB,0BAoDL,OApDK,+JAqDhB,KAAoB,cAApB,CAAmC,CAAE,OAAO,CAAP,OAAF,CAAnC,CArDgB,4DAwDrB,iBAxDqB,4BAwDH,SAxDG,qKAyDhB,KAAoB,cAApB,CAAmC,CAAE,SAAS,CAAT,SAAF,CAAnC,CAzDgB,6DA4DrB,8BA5DqB,yCA6DzB,4BA7DyB,kLA+DhB,KAAoB,cAApB,CAAmC,CAAE,4BAA4B,CAA5B,4BAAF,CAAnC,CA/DgB,6DAAtB","sourcesContent":["import { Asset } from 'expo-asset';\nimport { Platform } from '@unimodules/core';\n\nimport ExponentAV from './ExponentAV';\n// TODO add:\n//  disableFocusOnAndroid\n//  audio routes (at least did become noisy on android)\n//  pan\n//  pitch\n//  API to explicitly request audio focus / session\n//  API to select stream type on Android\n//  subtitles API\n\nexport enum PitchCorrectionQuality {\n  Low = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.Low,\n  Medium = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.Medium,\n  High = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.High,\n}\n\nexport type PlaybackSource =\n  | number\n  | {\n      uri: string;\n      overrideFileExtensionAndroid?: string;\n      headers?: { [fieldName: string]: string };\n    }\n  | Asset;\n\nexport type PlaybackNativeSource = {\n  uri: string;\n  overridingExtension?: string | null;\n  headers?: { [fieldName: string]: string };\n};\n\nexport type PlaybackStatus =\n  | {\n      isLoaded: false;\n      androidImplementation?: string;\n      error?: string; // populated exactly once when an error forces the object to unload\n    }\n  | {\n      isLoaded: true;\n      androidImplementation?: string;\n\n      uri: string;\n\n      progressUpdateIntervalMillis: number;\n      durationMillis?: number;\n      positionMillis: number;\n      playableDurationMillis?: number;\n      seekMillisToleranceBefore?: number;\n      seekMillisToleranceAfter?: number;\n\n      shouldPlay: boolean;\n      isPlaying: boolean;\n      isBuffering: boolean;\n\n      rate: number;\n      shouldCorrectPitch: boolean;\n      volume: number;\n      isMuted: boolean;\n      isLooping: boolean;\n\n      didJustFinish: boolean; // true exactly once when the track plays to finish\n    };\n\nexport type PlaybackStatusToSet = {\n  androidImplementation?: string;\n  progressUpdateIntervalMillis?: number;\n  positionMillis?: number;\n  seekMillisToleranceBefore?: number;\n  seekMillisToleranceAfter?: number;\n  shouldPlay?: boolean;\n  rate?: number;\n  shouldCorrectPitch?: boolean;\n  volume?: number;\n  isMuted?: boolean;\n  isLooping?: boolean;\n  pitchCorrectionQuality?: PitchCorrectionQuality;\n};\n\nexport const _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS: number = 500;\nexport const _DEFAULT_INITIAL_PLAYBACK_STATUS: PlaybackStatusToSet = {\n  positionMillis: 0,\n  progressUpdateIntervalMillis: _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS,\n  shouldPlay: false,\n  rate: 1.0,\n  shouldCorrectPitch: false,\n  volume: 1.0,\n  isMuted: false,\n  isLooping: false,\n};\n\nexport function getNativeSourceFromSource(\n  source?: PlaybackSource | null\n): PlaybackNativeSource | null {\n  let uri: string | null = null;\n  let overridingExtension: string | null = null;\n  let headers: { [fieldName: string]: string } | undefined;\n\n  if (typeof source === 'string' && Platform.OS === 'web') {\n    return {\n      uri: source,\n      overridingExtension,\n      headers,\n    };\n  }\n\n  let asset: Asset | null = _getAssetFromPlaybackSource(source);\n  if (asset != null) {\n    uri = asset.localUri || asset.uri;\n  } else if (\n    source != null &&\n    typeof source !== 'number' &&\n    'uri' in source &&\n    typeof source.uri === 'string'\n  ) {\n    uri = source.uri;\n  }\n\n  if (uri == null) {\n    return null;\n  }\n\n  if (\n    source != null &&\n    typeof source !== 'number' &&\n    'overrideFileExtensionAndroid' in source &&\n    typeof source.overrideFileExtensionAndroid === 'string'\n  ) {\n    overridingExtension = source.overrideFileExtensionAndroid;\n  }\n\n  if (\n    source != null &&\n    typeof source !== 'number' &&\n    'headers' in source &&\n    typeof source.headers === 'object'\n  ) {\n    headers = source.headers;\n  }\n  return { uri, overridingExtension, headers };\n}\n\nfunction _getAssetFromPlaybackSource(source?: PlaybackSource | null): Asset | null {\n  if (source == null) {\n    return null;\n  }\n\n  let asset: Asset | null = null;\n  if (typeof source === 'number') {\n    asset = Asset.fromModule(source);\n  } else if (source instanceof Asset) {\n    asset = source;\n  }\n  return asset;\n}\n\nexport function assertStatusValuesInBounds(status: PlaybackStatusToSet): void {\n  if (typeof status.rate === 'number' && (status.rate < 0 || status.rate > 32)) {\n    throw new RangeError('Rate value must be between 0.0 and 32.0');\n  }\n  if (typeof status.volume === 'number' && (status.volume < 0 || status.volume > 1)) {\n    throw new RangeError('Volume value must be between 0.0 and 1.0');\n  }\n}\n\nexport async function getNativeSourceAndFullInitialStatusForLoadAsync(\n  source: PlaybackSource | null,\n  initialStatus: PlaybackStatusToSet | null,\n  downloadFirst: boolean\n): Promise<{\n  nativeSource: PlaybackNativeSource;\n  fullInitialStatus: PlaybackStatusToSet;\n}> {\n  // Get the full initial status\n  const fullInitialStatus: PlaybackStatusToSet =\n    initialStatus == null\n      ? _DEFAULT_INITIAL_PLAYBACK_STATUS\n      : {\n          ..._DEFAULT_INITIAL_PLAYBACK_STATUS,\n          ...initialStatus,\n        };\n  assertStatusValuesInBounds(fullInitialStatus);\n\n  if (typeof source === 'string' && Platform.OS === 'web') {\n    return {\n      nativeSource: {\n        uri: source,\n        overridingExtension: null,\n      },\n      fullInitialStatus,\n    };\n  }\n\n  // Download first if necessary.\n  let asset = _getAssetFromPlaybackSource(source);\n  if (downloadFirst && asset) {\n    // TODO we can download remote uri too once @nikki93 has integrated this into Asset\n    await asset.downloadAsync();\n  }\n\n  // Get the native source\n  const nativeSource: PlaybackNativeSource | null = getNativeSourceFromSource(source);\n\n  if (nativeSource === null) {\n    throw new Error(`Cannot load an AV asset from a null playback source`);\n  }\n\n  return { nativeSource, fullInitialStatus };\n}\n\nexport function getUnloadedStatus(error: string | null = null): PlaybackStatus {\n  return {\n    isLoaded: false,\n    ...(error ? { error } : null),\n  };\n}\n\nexport interface AV {\n  setStatusAsync(status: PlaybackStatusToSet): Promise<PlaybackStatus>;\n}\n\nexport interface Playback extends AV {\n  playAsync(): Promise<PlaybackStatus>;\n  playFromPositionAsync(\n    positionMillis: number,\n    tolerances?: { toleranceMillisBefore?: number; toleranceMillisAfter?: number }\n  ): Promise<PlaybackStatus>;\n  pauseAsync(): Promise<PlaybackStatus>;\n  stopAsync(): Promise<PlaybackStatus>;\n  setPositionAsync(\n    positionMillis: number,\n    tolerances?: { toleranceMillisBefore?: number; toleranceMillisAfter?: number }\n  ): Promise<PlaybackStatus>;\n  setRateAsync(\n    rate: number,\n    shouldCorrectPitch: boolean,\n    pitchCorrectionQuality?: PitchCorrectionQuality\n  ): Promise<PlaybackStatus>;\n  setVolumeAsync(volume: number): Promise<PlaybackStatus>;\n  setIsMutedAsync(isMuted: boolean): Promise<PlaybackStatus>;\n  setIsLoopingAsync(isLooping: boolean): Promise<PlaybackStatus>;\n  setProgressUpdateIntervalAsync(progressUpdateIntervalMillis: number): Promise<PlaybackStatus>;\n}\n\n/**\n * A mixin that defines common playback methods for A/V classes so they implement the `Playback`\n * interface\n */\nexport const PlaybackMixin = {\n  async playAsync(): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ shouldPlay: true });\n  },\n\n  async playFromPositionAsync(\n    positionMillis: number,\n    tolerances: { toleranceMillisBefore?: number; toleranceMillisAfter?: number } = {}\n  ): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({\n      positionMillis,\n      shouldPlay: true,\n      seekMillisToleranceAfter: tolerances.toleranceMillisAfter,\n      seekMillisToleranceBefore: tolerances.toleranceMillisBefore,\n    });\n  },\n\n  async pauseAsync(): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ shouldPlay: false });\n  },\n\n  async stopAsync(): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ positionMillis: 0, shouldPlay: false });\n  },\n\n  async setPositionAsync(\n    positionMillis: number,\n    tolerances: { toleranceMillisBefore?: number; toleranceMillisAfter?: number } = {}\n  ): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({\n      positionMillis,\n      seekMillisToleranceAfter: tolerances.toleranceMillisAfter,\n      seekMillisToleranceBefore: tolerances.toleranceMillisBefore,\n    });\n  },\n\n  async setRateAsync(\n    rate: number,\n    shouldCorrectPitch: boolean = false,\n    pitchCorrectionQuality: PitchCorrectionQuality = PitchCorrectionQuality.Low\n  ): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({\n      rate,\n      shouldCorrectPitch,\n      pitchCorrectionQuality,\n    });\n  },\n\n  async setVolumeAsync(volume: number): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ volume });\n  },\n\n  async setIsMutedAsync(isMuted: boolean): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ isMuted });\n  },\n\n  async setIsLoopingAsync(isLooping: boolean): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ isLooping });\n  },\n\n  async setProgressUpdateIntervalAsync(\n    progressUpdateIntervalMillis: number\n  ): Promise<PlaybackStatus> {\n    return ((this as any) as AV).setStatusAsync({ progressUpdateIntervalMillis });\n  },\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}